<script>
  // Hide Zendesk Widget during business hours and show WiselyDesk Widget instead
  document.addEventListener("DOMContentLoaded", function () {
    const url = window.location.href;
    const nycBusinessHours = {
      start: 9,
      end: 17,
      timeZone: "America/New_York",
      locale: "en"
    };
    const berlinBusinessHours = {
      start: 9,
      end: 17,
      timeZone: "Europe/Berlin",
      locale: "de"
    };

    // Determine the appropriate timezone based on URL
    const { start, end, timeZone, locale } = url.includes("en-us")
      ? nycBusinessHours
      : berlinBusinessHours;

    const now = new Date();
    const localTime = new Date(now.toLocaleString("en-US", { timeZone }));

    const localHours = localTime.getHours();
    const dayOfWeek = localTime.getDay(); // Sunday = 0, Monday = 1, ..., Saturday = 6

    // Check if current time is outside business hours or on weekends
    if (
      localHours < start ||
      localHours >= end ||
      dayOfWeek === 0 ||
      dayOfWeek === 6
    ) {
      createWiselyDeskWidget(locale);
      hideZendeskWidget("#zw-customLauncher"); // assume Zendesk widget div contains this id
    }
  });

  function hideZendeskWidget(selector) {
    let attempts = 0;
    const maxAttempts = 50; // 10 seconds / 0.2 seconds per attempt

    const hideDivInterval = setInterval(function () {
      const div = document.querySelector(selector);
      if (div) {
        div.style.display = "none";
        clearInterval(hideDivInterval);
      } else if (attempts >= maxAttempts) {
        console.log("Missing div and max attempts reached.");
        clearInterval(hideDivInterval);
      }
      attempts++;
    }, 200);
  }

  function createWiselyDeskWidget(locale) {
    // Determine the iframe URL based on the locale
    const iframeUrl =
      locale === "en"
        ? "https://apps.wiselydesk.com/widget/2JcUUnHpgW5PAObuSmSGCsCRgW3Hhqg5yiznEZnAzzY"
        : "https://apps.wiselydesk.com/widget/hYn1picbsJfRm6vNUMOKv1ANYFSD4mZNTgsiw7LdHnE";
    const iframe = document.createElement("iframe");
    iframe.src = iframeUrl;
    iframe.style =
      "color-scheme: light; padding: 0px; width: 100%; height: 100%; position: fixed; bottom: 0px; overflow: visible; opacity: 1; border: 0px; transition-duration: 250ms; transition-timing-function: cubic-bezier(0.645, 0.045, 0.355, 1); transition-property: opacity, top, bottom; right: 0px;";
    document.body.appendChild(iframe);
  }
</script>
